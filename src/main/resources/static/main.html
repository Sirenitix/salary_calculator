<!DOCTYPE html>
<html lang="en" xmlns:v-slot="http://www.w3.org/1999/XSL/Transform" xmlns:width="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Калькулятор</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <link rel="preconnect" href="https://fonts.gstatic.com">
</head>


<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<body style="font-family: sans-serif">
<div id="app" data-app >

<!--   NAVBAR    -->
    <div>
        <v-toolbar
                dark
                prominent
                src="http://yesofcorsa.com/wp-content/uploads/2017/01/4K-Lights-Best-Wallpaper-1.jpg"
        >
            <v-app-bar-nav-icon @click.stop="drawer = !drawer" ></v-app-bar-nav-icon>

            <v-toolbar-title>Калькулятор</v-toolbar-title>

            <v-spacer></v-spacer>

            <v-btn icon @click="logout()" sec:authorize ="isAuthenticated()" th:href="@{/logout}">
                    <v-icon>mdi-export</v-icon>
            </v-btn>

            <v-btn icon @click="login()" sec:authorize="!isAuthenticated()" th:href="@{/login}">
                <v-icon>mdi-account</v-icon>
            </v-btn>

        </v-toolbar>
    </div>

    <!--   /NAVBAR    -->
    <v-sheet
            height=852
            class="overflow-hidden"
            style="position: relative;"

    >

<!--   About      -->
        <v-form v-if="isAbout">
            <v-container>
                <v-row>
                    <v-col
                            cols="12"
                            sm="4">

                    </v-col>
                    <v-col
                            cols="12"
                            sm="4">


                        <v-hover
                                v-slot="{ hover }"
                                disabled
                        >
                            <v-card
                                    :elevation="hover ? 12 : 2"
                                    class="mx-auto"
                                    height="350"
                                    max-width="350"
                            >
                                <v-card-text class="my-4 text-center text-h1">
                                    Служба технической поддержки
                                    Вы можете обратиться по телефону 8-777-574-25-40
                                    Или написать нам на адрес suleevn@gmail.com
                                </v-card-text>
                            </v-card>
                        </v-hover>

                    </v-col>
                    <v-col
                            cols="12"
                            sm="4">


                    </v-col>

                </v-row>
            </v-container>


        </v-form>
<!--           /About                -->
<!--              Additional section              -->



<!--              Additional section              -->


        <v-form v-if="!isAbout" ref="form">
            <v-container>
                <v-row>
                    <v-col
                            cols="12"
                            sm="4">

                        <v-select
                                v-model="title"
                                :items="titles"
                                :error-messages="errors"
                                label="Должность"
                                data-vv-name="Должность"
                                solo
                                required
                                :rules="fsRule"
                        ></v-select>

                        <v-select
                                v-model="education"
                                :items="educations"
                                :error-messages="errors"
                                label="Образование"
                                data-vv-name="Образование"
                                solo
                                required
                                :rules="sRule"
                        ></v-select>



                    </v-col>
                    <v-col
                            cols="12"
                            sm="4">

                        <v-select
                                v-model="category"
                                :items="categories"
                                :error-messages="errors"
                                label="Категория"
                                data-vv-name="Категория"
                                solo
                                required
                                :rules="tRule"
                        ></v-select>

                        <v-text-field
                                label="Стаж"
                                placeholder="Стаж"
                                v-model="experience"
                                th:type="number"
                                solo
                                :rules="fRule"
                        ></v-text-field>



                    </v-col>
                    <v-col
                            cols="12"
                            sm="4">

<!--      Date picker                  -->

                        <v-dialog
                                ref="dialog"
                                v-model="modal"
                                :return-value.sync="date"
                                persistent
                                width="290px"
                        >
                            <template v-slot:activator="{ on, attrs }">
                                <v-text-field
                                        v-model="date"
                                        label="За период"
                                        prepend-icon="mdi-calendar"
                                        readonly
                                        v-bind="attrs"
                                        v-on="on"
                                ></v-text-field>
                            </template>
                            <v-date-picker
                                    v-model="date"
                                    type="month"
                                    scrollable
                                    dark
                                    locale="ru"
                            >
                                <v-spacer></v-spacer>
                                <v-btn
                                        text
                                        dark
                                        @click="modal = false"
                                >
                                    Cancel
                                </v-btn>
                                <v-btn
                                        text
                                        dark
                                        @click="$refs.dialog.save(date)"
                                >
                                    OK
                                </v-btn>
                            </v-date-picker>
                        </v-dialog>

                        <v-text-field
                                label="Нагрузка"
                                placeholder="Нагрузка"
                                solo
                                v-model="loads"
                                th:type="number"
                                required
                                :rules="ffRule"
                        ></v-text-field>


                    </v-col>

                </v-row>
            </v-container>

            <v-row>
                <v-col
                        cols="12"
                        sm="4">
                </v-col>
            <v-col
                    cols="12"
                    sm="4">

            <v-container bg grid-list-md text-center>
                <v-layout row wrap align-center>
                    <v-flex>
                        <v-checkbox
                                v-model="checkbox" dense
                                :label="`Работа в сельской местности`"
                        ></v-checkbox>
                    </v-flex>
                </v-layout>
            </v-container>



            <v-container bg fill-height grid-list-md text-center>
                <v-layout row wrap align-center>
                    <v-flex>

                        <br>
<!--              Dialog window                -->

<!--                      Calculate buttons                   -->
                        <v-btn
                                color="accent"
                                elevation="11"
                                outlined
                                raised
                                rounded
                                text
                                large
                                inline
                                block
                                @click="validation();"
                        >Расчитать</v-btn>
                        <br>
                        <v-dialog
                                v-model="dialogTwo"
                                persistent
                                max-width="600px"
                        >

                            <template v-slot:activator="{ on, attrs }">
                                <v-btn
                                        v-bind="attrs"
                                        v-on="on"
                                        color="accent"
                                        elevation="11"
                                        outlined
                                        raised
                                        rounded
                                        text
                                        large
                                        inline
                                        block
                                >
                                       Расчитать с доплатой
                                </v-btn>
                            </template>
<!--       Additional pay section        -->
                                <v-card>
                                    <v-tabs>
                                        <v-tab>
                                            <v-icon left>
                                                mdi-account
                                            </v-icon>
                                            Секция 1
                                        </v-tab>
                                        <v-tab>
                                            <v-icon left>
                                                mdi-lock
                                            </v-icon>
                                            Секция 2
                                        </v-tab>

                                        <v-tab-item>
                                            <v-card-title>
                                                <span class="text-h5">Доплаты</span>
                                            </v-card-title>
                                            <v-card-text>
                                                <v-container>
                                                    <v-row>
                                                        <v-col
                                                                cols="12"
                                                                sm="6"
                                                                md="6"
                                                        >
                                                            <v-text-field
                                                                    label="Часы обновленного содержания"
                                                                    th:type="number"
                                                                    required
                                                            ></v-text-field>
                                                        </v-col>
                                                        <v-col
                                                                cols="12"
                                                                sm="6"
                                                                md="6"
                                                        >
                                                            <v-text-field
                                                                    label="Часы обучения на дому"
                                                                    th:type="number"
                                                            ></v-text-field>
                                                        </v-col>
                                                        <v-col
                                                                cols="12"
                                                        >
                                                            <v-text-field
                                                                    label="За часы работы с лицейскими и гимназическими классами"
                                                                    th:type="number"
                                                                    persistent-hint
                                                                    required
                                                            ></v-text-field>
                                                        </v-col>
                                                        <v-col cols="12">
                                                            <v-text-field
                                                                    label="За часы углубленного изучения"
                                                                    th:type="number"
                                                                    required
                                                            ></v-text-field>
                                                        </v-col>
                                                        <v-col cols="12">
                                                            <v-text-field
                                                                    label="За часы по предметам профильного назначения*"
                                                                    th:type="number"
                                                                    required
                                                            ></v-text-field>
                                                        </v-col>
                                                        <v-col
                                                                cols="12"
                                                                sm="6"
                                                        >
                                                            <v-select
                                                                    :items="['Весь день', 'Пол дня', 'Мастерской весь день', 'Мастерской пол дня']"
                                                                    label="За заведование кабинетом"
                                                                    required
                                                            ></v-select>
                                                        </v-col>
                                                        <v-col
                                                                cols="12"
                                                                sm="6"
                                                        >
                                                            <v-autocomplete
                                                                    :items="['1-4 классы полный', '1-4 классы неполный', '5-11 классы полный', '5-11 классы неполный']"
                                                                    label="За руководство"
                                                                    hint="Неполный класс до 14 включительно"
                                                            ></v-autocomplete>
                                                        </v-col>
                                                    </v-row>
                                                </v-container>
                                                <small>**Все поля являются необязательными</small>
                                            </v-card-text>
                                            <v-card-actions>
                                                <v-spacer></v-spacer>
                                                <v-btn
                                                        color="blue darken-1"
                                                        text
                                                        @click="dialogTwo = false"
                                                >
                                                    Закрыть
                                                </v-btn>
                                                <v-btn
                                                        color="blue darken-1"
                                                        text
                                                        @click="dialogTwo = false"
                                                >
                                                    Расчитать
                                                </v-btn>
                                            </v-card-actions>
                                        </v-tab-item>
                                        <v-tab-item>
                                            <v-card flat>
                                                <v-card-text>
                                                    <p>
                                                        Fusce a quam. Phasellus nec sem in justo pellentesque facilisis. Nam eget dui. Proin viverra, ligula sit amet ultrices semper, ligula arcu tristique sapien, a accumsan nisi mauris ac eros. In dui magna, posuere eget, vestibulum et, tempor auctor, justo.
                                                    </p>

                                                    <p class="mb-0">
                                                        Cras sagittis. Phasellus nec sem in justo pellentesque facilisis. Proin sapien ipsum, porta a, auctor quis, euismod ut, mi. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nam at tortor in tellus interdum sagittis.
                                                    </p>
                                                </v-card-text>
                                            </v-card>
                                        </v-tab-item>
                                    </v-tabs>

<!--           1 tab                     -->

        <!--           1 tab                     -->
<!--       Additional pay section        -->
                            </v-card>
                        </v-dialog>
<!--                        /Calculate buttons                   -->
                        <v-dialog
                                v-model="dialog"
                                persistent
                                max-width="390"
                                max-height="200"
                        >
                        <v-card>
                            <v-card-title class="text-h1" style="font-size: large" v-if="result" >
                                Итоговая зароботная плата:
                            </v-card-title>

                            <v-card-title class="text-h1" style="font-size: large" v-if="!result" >
                                Ошибка:
                            </v-card-title>

                            <v-card-text style="font-size: large; text-align: center;" v-if="result" >{{result}} тг</v-card-text>
                            <v-card-text style="font-size: large; text-align: center;" v-if="!result" >Некорректные данные</v-card-text>
                            <v-card-actions>
                                <v-spacer></v-spacer>
                                <v-btn
                                        color="green darken-1"
                                        text
                                        @click="dialog = false"
                                >
                                    OK
                                </v-btn>
                            </v-card-actions>
                        </v-card>
                        </v-dialog>
<!--        /Dialog window                 -->
                    </v-flex>
                </v-layout>
            </v-container>
            </v-col>
                <v-col
                        cols="12"
                        sm="4">
                </v-col>
            </v-row>

        </v-form>




<!-- Menu bar  -->
        <v-navigation-drawer
                v-model="drawer"
                v-if="drawer"
                absolute
                temporary
        >

            <v-list-item>
                <v-list-item-avatar>
                    <v-img src="https://cdn150.picsart.com/upscale-245339439045212.png"></v-img>
                </v-list-item-avatar>

                <v-list-item-content>
                    <v-list-item-title style="margin: 10px" >
                        <span sec:authorize="!isAuthenticated()" >Гость</span>
                        <span sec:authorize="isAuthenticated()" sec:authentication="name" ></span>
                        <span sec:authorize="isAuthenticated()" v-model="salary" >{{salary}} тг</span>
                    </v-list-item-title>
                </v-list-item-content>
            </v-list-item>

            <v-divider></v-divider>

            <v-list dense>
                <v-list-item  @click="isAbout = false"
                        link
                >
                    <v-list-item-icon>
                        <v-icon >mdi-view-dashboard</v-icon>
                    </v-list-item-icon>

                    <v-list-item-content >
                        <v-list-item-title >Главная страница</v-list-item-title>
                    </v-list-item-content>

                </v-list-item>

                <v-list-item
                        link
                        @click="isAbout = true"
                >

                    <v-list-item-icon>
                        <v-icon >mdi-forum</v-icon>
                    </v-list-item-icon>

                    <v-list-item-content >
                        <v-list-item-title  >Про приложение</v-list-item-title>
                    </v-list-item-content>

                </v-list-item>
            </v-list>
        </v-navigation-drawer>

    </v-sheet>
    <!-- /Menu bar  -->


</div>
</body>




<script>


    new Vue({
        el: '#app',
        name: 'main',
        vuetify: new Vuetify(),

        data () {
            return {
                drawer: null,
                items: [
                    { title: 'Главная страница', icon: 'mdi-view-dashboard', ref:'/' },
                    { title: 'Про приложение', icon: 'mdi-forum' , ref: '/about'},
                ],
                date: new Date().toISOString().substr(0, 7),
                menu: false,
                modal: false,
                checkbox: false,
                category: '',
                education: '',
                title: '',
                result: '',
                experience: '',
                loads: '',
                valid: true,
                salary: '',
                dialog: false,
                dialogTwo: false,
                isAbout: false,
                titles: [
                    'Учитель',
                ],
                educations: [
                    'Высшее',
                    'Среднее специальное'
                ],
                categories: [
                    'Без категории',
                    '2 категория',
                    '1 категория',
                    'Высшая категория'
                ],
                fsRule: [
                    v => v === '' ? 'Это обязательное поле' : false
                ],
                sRule: [
                    v => v === '' ? 'Это обязательное поле' : false
                ],
                tRule: [
                    v => v === '' ? 'Это обязательное поле' : false
                ],
                fRule: [
                    v => v === '' ? 'Это обязательное поле' : false
                ],
                ffRule: [
                    v => v === '' ? 'Это обязательное поле' : false
                ],

            }
        },

        mounted () {
            this.getSalary()
            setInterval(this.getSalary, 2000);
        },

        methods: {
            validation() {
                this.$refs.form.validate();
             if(this.title.trim() !== '' && this.category.trim() !== '' &&  this.experience.trim() !== '' && this.loads.trim() !== '' && this.education.trim() !== '' ){
                this.calculate();
                this.dialog = true;
             }
            },

            logout() {
                console.log("logging out")
            },
            login() {
                console.log("logging in")
            },
            getSalary(){
                axios.get("http://localhost:8080/salary")
                    .then(response => this.salary = response.data)
                    .catch(error => { console.error("There was an error!", error.message); });
            },
            calculate() {
                setTimeout(this.getSalary,1000);
                // POST request using axios with error handling
                const itemsToCalculate = {
                    category: this.category,
                    title: this.title,
                    education: this.education,
                    experience: this.experience,
                    date: this.date,
                    loads: this.loads,
                    checkbox: this.checkbox
                };

                axios.post("http://localhost:8080/calculate", itemsToCalculate)
                    .then(response =>  this.result = response.data)
                    .catch(error => { console.error("There was an error!", error.message); });

                console.log(this.result);

            }

        },

    })

</script>

</html>